<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ozon | –ü–æ–ª–∏—Ç–ú–∞–π—Ç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body { margin:0; font-family:Arial; background:#f3f3f7; }
header {
  background:#6a00ff; color:#fff; padding:12px;
  display:flex; justify-content:space-between; align-items:center;
}
.icon { cursor:pointer; font-size:20px; }

.container { padding:12px; }
.card {
  background:#fff; border-radius:16px; padding:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}
.card img {
  width:100%; aspect-ratio:1/1;
  object-fit:cover; border-radius:12px;
}
.price { color:#6a00ff; font-size:22px; font-weight:bold; }

button {
  width:100%; padding:14px; border:none;
  border-radius:12px; background:#6a00ff;
  color:white; font-size:16px; margin-top:8px;
}

.modal {
  display:none; position:fixed; inset:0;
  background:#fff; z-index:10; padding:12px;
  overflow:auto;
}

input {
  width:100%; padding:10px; margin:6px 0;
}
.small-btn {
  background:#aaa;
}
</style>
</head>

<body>

<header>
  <b>Ozon | –ü–æ–ª–∏—Ç–ú–∞–π—Ç</b>
</header>

<div class="container">
  <button onclick="openCart()">üß∫ –û—Ç–∫—Ä—ã—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
  <button onclick="openAdmin()" style="background:#444">‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞</button>
</div>


<div class="container">
  <div class="card">
    <img id="img" src="dern.png">
    <h3 id="name">–î—ë—Ä–Ω (—Ç—Ä–∞–≤–∞)</h3>
    <div>üì¶ –í –Ω–∞–ª–∏—á–∏–∏: <b id="stock">64</b></div>
    <div class="price"><span id="price">25</span> ‚ÇΩ / –±–ª–æ–∫</div>
    <button onclick="addToCart()">üõí –í –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
</div>

<!-- –ö–û–†–ó–ò–ù–ê -->
<div class="modal" id="cart">
  <h2>üß∫ –ö–æ—Ä–∑–∏–Ω–∞</h2>
  <div id="cartInfo"></div>

  <h3>–î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞</h3>
  <input id="nick" placeholder="–í–∞—à –Ω–∏–∫">
  <input id="receiver" placeholder="–ù–∏–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å)">
  <input id="server" placeholder="–°–µ—Ä–≤–µ—Ä">

  <button onclick="sendOrder()">üì¶ –ó–∞–∫–∞–∑–∞—Ç—å</button>
  <button class="small-btn" onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<!-- –ê–î–ú–ò–ù–ö–ê -->
<div class="modal" id="admin">
  <h2>‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>

  <div id="loginBox">
    <input id="adminUser" placeholder="–õ–æ–≥–∏–Ω">
    <input id="adminPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button onclick="adminLogin()">–í–æ–π—Ç–∏</button>
  </div>

  <div id="adminPanel" style="display:none">
    <input id="editName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
    <input id="editPrice" type="number" placeholder="–¶–µ–Ω–∞">
    <input id="editStock" type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
    <button onclick="saveProduct()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  </div>

  <button class="small-btn" onclick="closeAdmin()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// –î–ê–ù–ù–´–ï –¢–û–í–ê–†–ê (beta, –ª–æ–∫–∞–ª—å–Ω–æ)
let product = {
  name: "–î—ë—Ä–Ω (—Ç—Ä–∞–≤–∞)",
  price: 25,
  stock: 64
};

let cartCount = 0;

// ‚îÄ‚îÄ‚îÄ –ú–ê–ì–ê–ó–ò–ù ‚îÄ‚îÄ‚îÄ
function render() {
  name.innerText = product.name;
  price.innerText = product.price;
  stock.innerText = product.stock;
}
render();

function addToCart() {
  if (product.stock <= 0) {
    tg.showAlert("–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏");
    return;
  }
  cartCount++;
  product.stock--;
  render();
}

// ‚îÄ‚îÄ‚îÄ –ö–û–†–ó–ò–ù–ê ‚îÄ‚îÄ‚îÄ
function openCart() {
  cart.style.display = "block";
  cartInfo.innerText =
    `${product.name} √ó ${cartCount} = ${cartCount * product.price} ‚ÇΩ`;
}
function closeCart() {
  cart.style.display = "none";
}

// ‚îÄ‚îÄ‚îÄ –û–¢–ü–†–ê–í–ö–ê –ó–ê–ö–ê–ó–ê –í –ë–û–¢–ê ‚îÄ‚îÄ‚îÄ
function sendOrder() {
  if (cartCount === 0) {
    tg.showAlert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞");
    return;
  }

  const data = {
    product: product.name,
    count: cartCount,
    total: cartCount * product.price,
    nick: nick.value,
    receiver: receiver.value,
    server: server.value
  };

  tg.sendData(JSON.stringify(data));
  tg.close();
}

// ‚îÄ‚îÄ‚îÄ –ê–î–ú–ò–ù–ö–ê ‚îÄ‚îÄ‚îÄ
function openAdmin() {
  admin.style.display = "block";
}
function closeAdmin() {
  admin.style.display = "none";
}

function adminLogin() {
  if (adminUser.value === "IBrop" && adminPass.value === "1979") {
    loginBox.style.display = "none";
    adminPanel.style.display = "block";
    editName.value = product.name;
    editPrice.value = product.price;
    editStock.value = product.stock;
  } else {
    alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
  }
}

function saveProduct() {
  product.name = editName.value;
  product.price = Number(editPrice.value);
  product.stock = Number(editStock.value);
  render();
  alert("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ (–ª–æ–∫–∞–ª—å–Ω–æ)");
}
</script>

</body>
</html>
