<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ozon | –ü–æ–ª–∏—Ç–ú–∞–π—Ç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body { margin:0; font-family:Arial; background:#f3f3f7; }
header {
  background:#6a00ff; color:#fff; padding:12px;
  display:flex; justify-content:space-between; align-items:center;
}
.container { padding:12px; }

.card {
  background:#fff; border-radius:16px; padding:12px;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}

.card img {
  width:100%; aspect-ratio:1/1;
  object-fit:cover; border-radius:12px;
}

.price {
  color:#6a00ff; font-size:22px; font-weight:bold;
}

button {
  width:100%; padding:14px; border:none;
  border-radius:12px; background:#6a00ff;
  color:white; font-size:16px; margin-top:8px;
}

.admin-btn {
  background:#444;
}

.edit {
  border:2px dashed #6a00ff;
}

.modal {
  display:none; position:fixed; inset:0;
  background:#fff; z-index:10; padding:12px;
}

input {
  width:100%; padding:10px; margin:6px 0;
}
</style>
</head>

<body>

<header>
  <b>Ozon | –ü–æ–ª–∏—Ç–ú–∞–π—Ç</b>
  <button class="admin-btn" onclick="toggleAdmin()" id="adminToggle">
    ‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞
  </button>
</header>

<div class="container">

  <div class="card" id="productCard" onclick="cardClick()">
    <img src="dern.png">
    <h3 id="name">–î—ë—Ä–Ω (—Ç—Ä–∞–≤–∞)</h3>
    <div>üì¶ –í –Ω–∞–ª–∏—á–∏–∏: <b id="stock">64</b></div>
    <div class="price"><span id="price">25</span> ‚ÇΩ / –±–ª–æ–∫</div>

    <button onclick="addToCart(event)" id="cartBtn">
      üõí –í –∫–æ—Ä–∑–∏–Ω—É
    </button>
  </div>

</div>

<!-- –†–ï–î–ê–ö–¢–û–† -->
<div class="modal" id="editor">
  <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h2>

  <input id="editName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
  <input id="editPrice" type="number" placeholder="–¶–µ–Ω–∞">
  <input id="editStock" type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">

  <button onclick="saveEdit()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  <button class="admin-btn" onclick="closeEditor()">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let adminMode = false;

let product = {
  name: "–î—ë—Ä–Ω (—Ç—Ä–∞–≤–∞)",
  price: 25,
  stock: 64
};

let cartCount = 0;

// ‚îÄ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ‚îÄ
function render() {
  name.innerText = product.name;
  price.innerText = product.price;
  stock.innerText = product.stock;

  cartBtn.innerText = adminMode
    ? "üõí –í –∫–æ—Ä–∑–∏–Ω—É (–∞–¥–º–∏–Ω–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞)"
    : "üõí –í –∫–æ—Ä–∑–∏–Ω—É";

  adminToggle.innerText = adminMode
    ? "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞ (–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ)"
    : "‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞";

  productCard.classList.toggle("edit", adminMode);
}

render();

// ‚îÄ‚îÄ‚îÄ ADMIN MODE ‚îÄ‚îÄ‚îÄ
function toggleAdmin() {
  adminMode = !adminMode;
  render();
}

// ‚îÄ‚îÄ‚îÄ CARD CLICK ‚îÄ‚îÄ‚îÄ
function cardClick() {
  if (!adminMode) return;

  editor.style.display = "block";
  editName.value = product.name;
  editPrice.value = product.price;
  editStock.value = product.stock;
}

// ‚îÄ‚îÄ‚îÄ SAVE EDIT ‚îÄ‚îÄ‚îÄ
function saveEdit() {
  product.name = editName.value;
  product.price = Number(editPrice.value);
  product.stock = Number(editStock.value);
  closeEditor();
  render();
}

function closeEditor() {
  editor.style.display = "none";
}

// ‚îÄ‚îÄ‚îÄ CART ‚îÄ‚îÄ‚îÄ
function addToCart(e) {
  e.stopPropagation();

  if (adminMode) {
    tg.showAlert("–ê–¥–º–∏–Ω-—Ä–µ–∂–∏–º –≤–∫–ª—é—á—ë–Ω. –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É.");
    return;
  }

  if (product.stock <= 0) {
    tg.showAlert("–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏");
    return;
  }

  product.stock--;
  cartCount++;
  render();
}
</script>

</body>
</html>
