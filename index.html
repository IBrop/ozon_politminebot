<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ozon | –ü–æ–ª–∏—Ç–ú–∞–π–Ω</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f3f3f7;
}

header {
  background: #6a00ff;
  color: white;
  padding: 12px;
  text-align: center;
  font-weight: bold;
}

/* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.container {
  padding: 12px;
}

/* –∫–∞—Ä—Ç–æ—á–∫–∞ */
.card {
  background: white;
  border-radius: 16px;
  padding: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,.08);
}

.card.edit {
  border: 2px dashed #6a00ff;
}

.card img {
  width: 100%;
  aspect-ratio: 1 / 1;
  object-fit: cover;
  border-radius: 12px;
}

.price {
  color: #6a00ff;
  font-size: 22px;
  font-weight: bold;
}

/* –∫–Ω–æ–ø–∫–∏ */
button {
  width: 100%;
  padding: 14px;
  border: none;
  border-radius: 12px;
  background: #6a00ff;
  color: white;
  font-size: 16px;
  margin-top: 8px;
  cursor: pointer;
}

/* ‚öôÔ∏è –∞–¥–º–∏–Ω–∫–∞ */
.admin-gear {
  position: fixed;
  top: 10px;
  right: 10px;
  background: #444;
  color: white;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  border: none;
  font-size: 18px;
  z-index: 20;
}

/* üß∫ –∫–æ—Ä–∑–∏–Ω–∞ */
.cart-btn {
  position: fixed;
  top: 10px;
  left: 10px;
  background: #6a00ff;
  color: white;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  border: none;
  font-size: 18px;
  z-index: 20;
}

/* –≤—Å–ø–ª—ã–≤–∞—à–∫–∏ */
.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #2ecc71;
  color: white;
  padding: 10px 18px;
  border-radius: 20px;
  display: none;
  z-index: 40;
}

/* –º–æ–¥–∞–ª–∫–∏ */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.4);
  z-index: 30;
}

.modal-box {
  background: white;
  margin: 15% auto;
  padding: 16px;
  width: 90%;
  max-width: 400px;
  border-radius: 16px;
}

input {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
}
</style>
</head>

<body>

<header>Ozon | –ü–æ–ª–∏—Ç–ú–∞–π–Ω</header>

<!-- üß∫ –ö–æ—Ä–∑–∏–Ω–∞ -->
<button class="cart-btn" onclick="openCart()">üß∫</button>

<!-- ‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞ -->
<button class="admin-gear" onclick="toggleAdmin()">‚öôÔ∏è</button>

<div class="container">
  <div class="card" id="productCard" onclick="cardClick()">
    <img src="dern.png" alt="–î—ë—Ä–Ω">
    <h3 id="name"></h3>
    <div>üì¶ –í –Ω–∞–ª–∏—á–∏–∏: <b id="stock"></b></div>
    <div class="price"><span id="price"></span> ‚ÇΩ / –±–ª–æ–∫</div>
    <button onclick="addToCart(event)">üõí –í –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
</div>

<!-- üß∫ –ö–û–†–ó–ò–ù–ê -->
<div class="modal" id="cartModal">
  <div class="modal-box">
    <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
    <div id="cartInfo"></div>
    <button onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<!-- ‚úèÔ∏è –†–ï–î–ê–ö–¢–û–† -->
<div class="modal" id="editModal">
  <div class="modal-box">
    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h2>
    <input id="editName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
    <input id="editPrice" type="number" placeholder="–¶–µ–Ω–∞">
    <input id="editStock" type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
    <button onclick="saveEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
  </div>
</div>

<div class="toast" id="toast">–ê–¥–º–∏–Ω–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

/* ‚îÄ‚îÄ‚îÄ –ù–ê–°–¢–†–û–ô–ö–ò ‚îÄ‚îÄ‚îÄ */
const ADMIN_PASSWORD = "123456";

/* ‚îÄ‚îÄ‚îÄ LOCAL STORAGE ‚îÄ‚îÄ‚îÄ */
const defaultProduct = { name:"–î—ë—Ä–Ω (—Ç—Ä–∞–≤–∞)", price:25, stock:64 };
let product = JSON.parse(localStorage.getItem("product")) || defaultProduct;
let cartCount = Number(localStorage.getItem("cart")) || 0;

let adminMode = false;

/* ‚îÄ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ‚îÄ */
function render() {
  name.innerText = product.name;
  price.innerText = product.price;
  stock.innerText = product.stock;
  cartInfo.innerText = `${product.name} √ó ${cartCount} = ${cartCount * product.price} ‚ÇΩ`;
  productCard.classList.toggle("edit", adminMode);

  localStorage.setItem("product", JSON.stringify(product));
  localStorage.setItem("cart", cartCount);
}
render();

/* ‚îÄ‚îÄ‚îÄ –ö–û–†–ó–ò–ù–ê ‚îÄ‚îÄ‚îÄ */
function addToCart(e) {
  e.stopPropagation();
  if (product.stock <= 0) {
    tg.showAlert("–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏");
    return;
  }
  product.stock--;
  cartCount++;
  render();
}

function openCart() {
  cartModal.style.display = "block";
}

function closeCart() {
  cartModal.style.display = "none";
}

/* ‚îÄ‚îÄ‚îÄ –ê–î–ú–ò–ù–ö–ê ‚îÄ‚îÄ‚îÄ */
function toggleAdmin() {
  if (!adminMode) {
    const pass = prompt("–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:");
    if (pass !== ADMIN_PASSWORD) return;
    adminMode = true;
    showToast();
  } else {
    adminMode = false;
  }
  render();
}

function cardClick() {
  if (!adminMode) return;
  editModal.style.display = "block";
  editName.value = product.name;
  editPrice.value = product.price;
  editStock.value = product.stock;
}

function saveEdit() {
  product.name = editName.value;
  product.price = Number(editPrice.value);
  product.stock = Number(editStock.value);
  editModal.style.display = "none";
  render();
}

/* ‚îÄ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ‚îÄ */
function showToast() {
  toast.style.display = "block";
  setTimeout(() => toast.style.display = "none", 2000);
}
</script>

</body>
</html>
